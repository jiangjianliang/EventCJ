CompilationUnit(
  Some(PackageDec([], PackageName([Id("main")])))
, []
, [ Direction(
      Id("StorageDir")
    , [ EventDecl(
          Id("Activate")
        , [Param(
             []
           , ClassOrInterfaceType(TypeName(Id("Storage")), None())
           , Id("s")
           )]
        , AndComp(
            ActionSelector(
              AfterTiming()
            , Call(
                MethodPattern(
                  AnnoPattern([])
                , ModPattern([])
                , Void()
                , MemberName(RefTypePattern(NamePattern("Storage")), "doSomething")
                , []
                , None()
                )
              )
            )
          , TargetSelector(ClassOrInterfaceType(TypeName(Id("s")), None()))
          )
        , Some(SendTo(ExprName(Id("s"))))
        )
      , TransitionRuleDecl(Id("Activate"), [], ActivateLayer(AnnonLayer(), Id("cacheLayer")))
      ]
    )
  , ClassDec(
      ClassDecHead([Public()], Id("Storage"), None(), None(), None())
    , ClassBody(
        [ Layer(
            Id("cacheLayer")
          , [ PartialMethodDec(
                PartialMethodHead(
                  None()
                , AroundTiming()
                , Void()
                , Id("getItem")
                , [Param([], Int(), Id("key"))]
                , None()
                )
              , Block(
                  [ ExprStm(
                      Invoke(
                        Method(
                          MethodName(
                            AmbName(AmbName(Id("System")), Id("out"))
                          , Id("println")
                          )
                        )
                      , [Lit(String([Chars("Cache Lookup")]))]
                      )
                    )
                  ]
                )
              )
            ]
          )
        , MethodDec(
            MethodDecHead(
              []
            , None()
            , Void()
            , Id("getItem")
            , [Param([], Int(), Id("key"))]
            , None()
            )
          , Block(
              [ ExprStm(
                  Invoke(
                    Method(
                      MethodName(
                        AmbName(AmbName(Id("System")), Id("out"))
                      , Id("println")
                      )
                    )
                  , [Lit(String([Chars("Disk Lookup")]))]
                  )
                )
              ]
            )
          )
        , MethodDec(
            MethodDecHead([], None(), Void(), Id("doSomething"), [], None())
          , Block([])
          )
        , MethodDec(
            MethodDecHead(
              [Public(), Static()]
            , None()
            , Void()
            , Id("main")
            , [ Param(
                  []
                , ArrayType(ClassOrInterfaceType(TypeName(Id("String")), None()))
                , Id("args")
                )
              ]
            , None()
            )
          , Block(
              [ LocalVarDecStm(
                  LocalVarDec(
                    []
                  , ClassOrInterfaceType(TypeName(Id("Storage")), None())
                  , [ VarDec(
                        Id("s")
                      , NewInstance(
                          None()
                        , ClassOrInterfaceType(TypeName(Id("Storage")), None())
                        , []
                        , None()
                        )
                      )
                    ]
                  )
                )
              , ExprStm(
                  Invoke(
                    Method(MethodName(AmbName(Id("s")), Id("getItem")))
                  , [Lit(Deci("10"))]
                  )
                )
              , ExprStm(
                  Invoke(
                    Method(MethodName(AmbName(Id("s")), Id("doSomething")))
                  , []
                  )
                )
              , ExprStm(
                  Invoke(
                    Method(MethodName(AmbName(Id("s")), Id("getItem")))
                  , [Lit(Deci("10"))]
                  )
                )
              ]
            )
          )
        ]
      )
    )
  ]
)